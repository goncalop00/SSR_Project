Setup with 2 different VMs, connected via network interface epns03


 VM1 â€“ ConfiguraÃ§Ã£o do Suricata (IDS)
ðŸ“¦ 2.1 Instalar Suricata
sudo apt update && sudo apt install -y suricata
ðŸ“ 2.2 Criar regras locais
sudo nano /etc/suricata/rules/local.rules
Adiciona as regras:
alert tcp any any -> 10.0.0.10 80 (msg:"TCP SYN Flood Detected"; flags:S; flow:to_server; sid:1000001;)
alert udp any any -> 10.0.0.10 80 (msg:"UDP Flood Detected"; flow:to_server; sid:1000002;)
alert icmp any any -> 10.0.0.10 any (msg:"ICMP Ping Detected"; sid:1000003;)
alert http any any -> 10.0.0.10 80 (msg:"HTTP GET Flood Detected"; content:"GET"; http_method; sid:1000004;)

ðŸ§ª 2.3 Verificar se as regras estÃ£o a ser lidas
sudo suricata -T -c /etc/suricata/suricata.yaml -v

Esperado: 4 rules successfully loaded
ðŸŒ 2.4 Iniciar servidor HTTP (necessÃ¡rio para ataque GET)
cd ~
sudo python3 -m http.server 80
ðŸ›¡ï¸ 2.5 Iniciar o Suricata
Noutro terminal:
sudo timeout 600s suricata -c /etc/suricata/suricata.yaml -i enp0s3
sudo suricata -c /etc/suricata/suricata.yaml -i enp0s3
ðŸ‘ï¸ 2.6 Monitorar alertas
sudo tail -f /var/log/suricata/fast.log


ðŸ’£ 3. VM2 â€“ Enviar os ataques com Scapy e cURL
ðŸ§° 3.1 Instalar Scapy
sudo apt update && sudo apt install -y python3-pip curl
pip3 install scapy

ðŸš€ 3.2 Enviar os ataques:
# Abrir Python
sudo python3
ðŸ”¹ TCP SYN Flood
from scapy.all import *
send(IP(dst="10.0.0.10")/TCP(dport=80, flags="S"), count=200)

ðŸ”¹ UDP Flood
send(IP(dst="10.0.0.10")/UDP(dport=80), count=200)

ðŸ”¹ ICMP Ping Flood
send(IP(dst="10.0.0.10")/ICMP(), count=100)

ðŸ”¹ HTTP GET Flood
1. Abre um terminal na VM1 (Suricata/VÃ­tima)
2. Executa o seguinte comando:
sudo python3 -m http.server 80
Depois na VM2 executar o seguinte comando:
for i in {1..100}; do curl http://10.0.0.10 > /dev/null 2>&1 & done


ðŸ“Š 4. Resultados
Verifica os alertas no fast.log


Exporta os alertas:
cp /var/log/suricata/fast.log ~/suricata_alerts.txt
VM2 
sudo tcpdump -i enp0s3 port 80 and tcp
